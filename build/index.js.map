{"version":3,"sources":["db/index.js","src/handleData/index.js","db/create.js","index.js"],"names":["dbConn","sqlite3","verbose","dbConnection","Database","err","console","log","message","getTrackInfo","trackNumber","data","Axios","get","$","cheerio","load","dataRows","events","each","date","children","text","event","push","addOrUpdateData","userId","trackingNumber","sql","DB","run","lastEntries","all","rows","createTable","close"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;;;AAEA,MAAMA,MAAM,GAAGC,gBAAQC,OAAR,EAAf;;AAEA,MAAMC,YAAY,GAAG,IAAIH,MAAM,CAACI,QAAX,CAAoB,WAApB,EAAkCC,GAAD,IAAS;AAC3D,MAAIA,GAAJ,EAAS;AACLC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAG,CAACG,OAAhB;AACH;;AACDF,EAAAA,OAAO,CAACC,GAAR,CAAY,WAAZ;AACH,CALoB,CAArB;eAOeJ;;;;;;;;;;ACXf;;AACA;;AACA;;;;;;;;AAEO,MAAMM,YAAY,GAAG,MAAMC,WAAN,IAAqB;AAC/C,QAAM;AAAEC,IAAAA;AAAF,MAAW,MAAMC,eAAMC,GAAN,CACpB,kCAAiCH,WAAY,EADzB,CAAvB;AAGA,QAAMI,CAAC,GAAGC,OAAO,CAACC,IAAR,CAAaL,IAAb,CAAV;AACA,QAAMM,QAAQ,GAAGH,CAAC,CAAC,MAAD,CAAlB;AACA,QAAMI,MAAM,GAAG,EAAf;AAEAD,EAAAA,QAAQ,CAACE,IAAT,CAAc,YAAW;AACvB,UAAMC,IAAI,GAAGN,CAAC,CAAC,IAAD,CAAD,CACVO,QADU,CACD,8BADC,EAEVC,IAFU,EAAb;AAGA,UAAMC,KAAK,GAAGT,CAAC,CAAC,IAAD,CAAD,CACXO,QADW,CACF,+BADE,EAEXC,IAFW,EAAd;AAIAJ,IAAAA,MAAM,CAACM,IAAP,CAAY;AAAEJ,MAAAA,IAAF;AAAQG,MAAAA;AAAR,KAAZ;AACD,GATD;AAWA,SAAOL,MAAP;AACD,CApBM;;;;AAsBA,MAAMO,eAAe,GAAG,OAAO;AAAEd,EAAAA,IAAF;AAAQe,EAAAA,MAAR;AAAgBC,EAAAA;AAAhB,CAAP,KAA4C;AACzE,QAAMC,GAAG,GAAI,sCAAb;AACAtB,EAAAA,OAAO,CAACC,GAAR,CAAYqB,GAAZ;;AACAC,cAAGC,GAAH,CAAOF,GAAP,EAAYvB,GAAG,IAAI;AACjBC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACD,GAFD;AAGD,CANM;;;;AAQA,MAAM0B,WAAW,GAAG,YAAY;AACrCF,cAAGG,GAAH,CAAO,2EAAP,EAAoF,EAApF,EAAwF,CAAC3B,GAAD,EAAM4B,IAAN,KAAe;AACrG3B,IAAAA,OAAO,CAACC,GAAR,CAAY0B,IAAZ;AACD,GAFD;AAGD,CAJM;;;;;;;;;;;AClCP;;;;AAEO,MAAMC,WAAW,GAAG,MAAM;AAC7BL,iBAAGC,GAAH,CAAO,yIAAP,EAAmJzB,GAAD,IAAS;AACvJC,IAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;AACH,GAFD;;AAIAwB,iBAAGM,KAAH;AACH,CANM;;;;;;ACDP;;AACA;;AAEA,CAAC,YAAY;AACT;AACA,QAAMxB,IAAI,GAAG,MAAM,8BAAa,eAAb,CAAnB;AACAL,EAAAA,OAAO,CAACC,GAAR,CAAYI,IAAZ;AACA,mCAAgB;AAAEe,IAAAA,MAAM,EAAE,CAAV;AAAaC,IAAAA,cAAc,EAAE,eAA7B;AAA8ChB,IAAAA;AAA9C,GAAhB,EAJS,CAKT;;AACAL,EAAAA,OAAO,CAACC,GAAR,CAAY,IAAZ;AAEH,CARD","file":"index.js","sourceRoot":"..","sourcesContent":["import sqlite3 from 'sqlite3';\n\nconst dbConn = sqlite3.verbose();\n\nconst dbConnection = new dbConn.Database('./data.db', (err) => {\n    if (err) {\n        console.log(err.message);\n    }\n    console.log('Connected');\n})\n\nexport default dbConnection;","import * as cheerio from \"cheerio\"\nimport Axios from \"axios\"\nimport DB from \"../../db\"\n\nexport const getTrackInfo = async trackNumber => {\n  const { data } = await Axios.get(\n    `http://posta.md/ro/tracking?id=${trackNumber}`\n  )\n  const $ = cheerio.load(data)\n  const dataRows = $(\".row\")\n  const events = []\n\n  dataRows.each(function() {\n    const date = $(this)\n      .children(\".tracking-result-header-date\")\n      .text()\n    const event = $(this)\n      .children(\".tracking-result-header-event\")\n      .text()\n\n    events.push({ date, event })\n  })\n\n  return events\n}\n\nexport const addOrUpdateData = async ({ data, userId, trackingNumber }) => {\n  const sql = `CASE EXISTS ( select * from TRACKS )`\n  console.log(sql)\n  DB.run(sql, err => {\n    console.log(err)\n  })\n}\n\nexport const lastEntries = async () => {\n  DB.all(\"select * from TRACKS where user_id='1' AND trackingNumber='RP877761813CN'\", [], (err, rows) => {\n    console.log(rows)\n  })\n}\n","import DB from './index';\n\nexport const createTable = () => {\n    DB.run('CREATE TABLE TRACKS(\"user_id\" INTEGER, trackingNumber varchar(256), \"trackinfo\" nvarchar(1000), \"id\" INTEGER PRIMARY KEY AUTOINCREMENT)', (err) => {\n        console.log(err);\n    });\n\n    DB.close();\n}","\nimport { getTrackInfo, addOrUpdateData, lastEntries } from './src/handleData';\nimport { createTable } from './db/create';\n\n(async () => {\n    // createTable();\n    const data = await getTrackInfo('RP877761813CN')\n    console.log(data);\n    addOrUpdateData({ userId: 1, trackingNumber: 'RP877761813CN', data })\n    // lastEntries();\n    console.log('da')\n\n})()"]}